{"version":3,"file":"static/js/345.f9e2a2bb.chunk.js","mappings":"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","sources":["webpack://react-homework-template/./src/components/Pagination/Pagination.module.css?4da5","components/Pagination/Pagination.jsx","components/pages/MovieByGenPage/findPagesWithGenre.js","components/pages/MovieByGenPage/MovieByGenPage.jsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"pagination\":\"Pagination_pagination__vcNDC\",\"active\":\"Pagination_active__DDld0\"};","import React from \"react\";\nimport styles from \"./Pagination.module.css\";\n\nconst Pagination = ({ currentPage, totalPages, onPageChange }) => {\n  const maxPagesToShow = 5;\n\n  const getPageNumbers = () => {\n    let start = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));\n    let end = start + maxPagesToShow - 1;\n\n    if (end > totalPages) {\n      end = totalPages;\n      start = Math.max(1, end - maxPagesToShow + 1);\n    }\n\n    let pages = [];\n    for (let i = start; i <= end; i++) {\n      pages.push(i);\n    }\n    return pages;\n  };\n\n  const pageNumbers = getPageNumbers();\n\n  return (\n    <div className={styles.pagination}>\n      <button\n        disabled={currentPage === 1}\n        onClick={() => onPageChange(1)}\n      >\n        ⏮ First\n      </button>\n\n      <button\n        disabled={currentPage === 1}\n        onClick={() => onPageChange(currentPage - 1)}\n      >\n        ◀ Prev\n      </button>\n\n      {pageNumbers[0] > 1 && <span>...</span>}\n      {pageNumbers.map((num) => (\n        <button \n          key={num}\n          className={num === currentPage ? styles.active : \"\"}\n          onClick={() => onPageChange(num)}\n        >\n          {num}\n        </button>\n      ))}\n      {pageNumbers[pageNumbers.length - 1] < totalPages && <span>...</span>}\n\n      <button\n        disabled={currentPage === totalPages}\n        onClick={() => onPageChange(currentPage + 1)}\n      >\n        Next ▶\n      </button>\n\n      <button\n        disabled={currentPage === totalPages}\n        onClick={() => onPageChange(totalPages)}\n      >\n        Last ⏭\n      </button>\n    </div>\n  );\n};\n\nexport default Pagination;\n","import { getAll } from \"../../../redux/movies/getAPI\";\n\nconst findPagesWithGenre = async (\n  dispatch,\n  genId,\n  maxPagesToCheck = 500,\n  batchSize = 5,\n) => {\n  const genreIdNumber = parseInt(genId);\n  const foundPages = [];\n\n  for (let start = 1; start <= maxPagesToCheck; start += batchSize) {\n    const batch = Array.from({ length: batchSize }, (_, i) => start + i)\n      .filter(page => page <= maxPagesToCheck);\n\n    const responses = await Promise.allSettled(\n      batch.map(page => dispatch(getAll(page)))\n    );\n\n    for (const [index, result] of responses.entries()) {\n      if (result.status === \"fulfilled\") {\n        const movies = result.value.payload?.results || [];\n\n        const hasGenre = movies.some(\n          m => Array.isArray(m.genre_ids) && m.genre_ids.includes(genreIdNumber)\n        );\n\n        if (hasGenre) {\n          foundPages.push(batch[index]);\n        }\n      }\n    }\n\n    if (start + batchSize > maxPagesToCheck) break;\n  }\n\n  return foundPages;\n};\n\n\nexport default findPagesWithGenre;","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { getAll, IMAGE_URL } from '../../../redux/movies/getAPI';\nimport { useDispatch } from 'react-redux';\nimport Pagination from '../../Pagination/Pagination';\nimport noImage from '../../Images/no_image.jpg';\nimport { useParams } from 'react-router-dom';\nimport findPagesWithGenre from './findPagesWithGenre';\nimport Loader from 'components/Loader/Loader';\nimport './MovieByGenPage.css';\n\n\nconst ITEMS_PER_PAGE = 20;\n\nconst MovieByGenPage = () => {\n  const [allFilteredMovies, setAllFilteredMovies] = useState([]);\n  const [movies, setMovies] = useState([]);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const dispatch = useDispatch();\n  const params = useParams();\n  const genId = params.genId;\n  const genreName = params.genName;\n\n  const filterByGenre = (items, genId) => {\n    const genreId = parseInt(genId);\n    return items.filter(item => (\n      item.genre_ids && item.genre_ids.includes(genreId)\n    ));\n  };\n\n  useEffect(() => {\n    const fetchAndAggregateMovies = async () => {\n      setIsLoading(true);\n      try {\n        const relevantPages = await findPagesWithGenre(dispatch, genId, 500);\n\n        if (relevantPages.length === 0) {\n          setAllFilteredMovies([]);\n          setTotalPages(1);\n          return;\n        }\n\n        const responses = await Promise.all(\n          relevantPages.map(page => dispatch(getAll(page)))\n        );\n\n        let aggregatedMovies = [];\n\n        responses.forEach(response => {\n          if (response.payload?.results) {\n            const filtered = filterByGenre(response.payload.results, genId);\n            aggregatedMovies = [...aggregatedMovies, ...filtered];\n          }\n        });\n\n        setAllFilteredMovies(aggregatedMovies);\n        const newTotalPages = Math.ceil(aggregatedMovies.length / ITEMS_PER_PAGE);\n        setTotalPages(newTotalPages);\n        setCurrentPage(1);\n        \n      } catch (error) {\n        console.error(\"Error fetching and aggregating movies:\", error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchAndAggregateMovies();\n  }, [dispatch, genId]);\n\n  useEffect(() => {\n    const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;\n    const endIndex = startIndex + ITEMS_PER_PAGE;\n    const moviesToShow = allFilteredMovies.slice(startIndex, endIndex);\n    \n    setMovies(moviesToShow);\n  }, [allFilteredMovies, currentPage]);\n\n  const handlePageChange = (newPage) => {\n    setCurrentPage(newPage);\n  };\n\n  return (\n    <section className='page'>\n      <h1>Gen: {genreName}</h1>\n      \n      {isLoading ? \n        <Loader/> \n      : (\n        <>\n          {allFilteredMovies.length === 0 ? (\n            <p>Nu au fost găsite rezultate pentru acest gen.</p>\n          ) : (\n            <ul className='pageList'>\n              {movies.map((movie, i) => (\n                <Link className='pageItem' key={i} to={`/movie/${movie.id}`}>\n                  <img\n                    src={movie.poster_path ? IMAGE_URL + movie.poster_path : noImage}\n                    alt={movie.title || movie.name}\n                  />\n                  <h2>{movie.title || movie.name}</h2>\n                </Link>\n              ))}\n            </ul>\n          )}\n\n          {totalPages > 1 && (\n            <Pagination\n              currentPage={currentPage}\n              totalPages={totalPages}\n              onPageChange={handlePageChange}\n            />\n          )}\n        </>\n      )}\n    </section>\n  );\n};\n\nexport default MovieByGenPage;\n\n\n\n"],"names":["_ref","currentPage","totalPages","onPageChange","pageNumbers","start","Math","max","floor","maxPagesToShow","end","pages","i","push","getPageNumbers","_jsxs","className","styles","children","_jsx","disabled","onClick","map","num","length","findPagesWithGenre","_asyncToGenerator","_regeneratorRuntime","_callee","dispatch","genId","maxPagesToCheck","batchSize","genreIdNumber","foundPages","_loop","_args2","arguments","_context2","prev","next","undefined","parseInt","batch","responses","_iterator","_step","_step$value","index","result","_result$value$payload","movies","_context","Array","from","_","filter","page","Promise","allSettled","getAll","sent","_createForOfIteratorHelper","entries","s","n","done","_slicedToArray","value","status","payload","results","some","m","isArray","genre_ids","includes","err","e","f","abrupt","stop","delegateYield","t0","_x","_x2","apply","_useState","useState","_useState2","allFilteredMovies","setAllFilteredMovies","_useState3","_useState4","setMovies","_useState5","_useState6","setCurrentPage","_useState7","_useState8","setTotalPages","_useState9","_useState10","isLoading","setIsLoading","useDispatch","params","useParams","genreName","genName","filterByGenre","items","genreId","item","useEffect","fetchAndAggregateMovies","relevantPages","aggregatedMovies","newTotalPages","all","forEach","response","_response$payload","filtered","concat","_toConsumableArray","ceil","console","error","finish","startIndex","endIndex","moviesToShow","slice","Loader","_Fragment","movie","Link","to","id","src","poster_path","IMAGE_URL","noImage","alt","title","name","Pagination","newPage"],"sourceRoot":""}